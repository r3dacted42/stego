(function(){"use strict";const s=["​","‍","‌","\uFEFF"];self.onmessage=S=>{try{const{encTxt:r}=S.data;let t="";for(const e of r)s.includes(e)&&(t+=e);const n=t.length;if(n<16){self.postMessage({error:"no message found or data is corrupted (header missing)."});return}const _=Math.floor(n/4),o=new Uint8Array(_);let c=0;for(let e=0;e<n;e+=4){const a=t.substring(e,e+4);if(a.length<4)break;const f=s.indexOf(a[0]),l=s.indexOf(a[1]),u=s.indexOf(a[2]),g=s.indexOf(a[3]);if(f===-1||l===-1||u===-1||g===-1){self.postMessage({error:`corrupted data: invalid ZW char detected at chunk ${c}.`});return}const A=g<<6|u<<4|l<<2|f;o[c]=A,c++}const h=o.subarray(0,4),d=new DataView(h.buffer).getUint32(0,!1),E=d,i=o.length-4;if(E>i){self.postMessage({error:`corrupted data: header indicates ${E} bytes, but only ${i} were found.`});return}const y=o.subarray(4,4+d),p={message:new TextDecoder().decode(y)};self.postMessage(p)}catch(r){const t=r;self.postMessage({error:t.message})}}})();
