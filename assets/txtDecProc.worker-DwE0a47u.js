(function(){"use strict";const t=["​","‍","‌","\uFEFF"];self.onmessage=_=>{try{const{encTxt:n}=_.data;let s="";for(const e of n)t.includes(e)&&(s+=e);const r=s.length;if(r<16)throw new Error("No message found or data is corrupted (header missing).");const y=Math.floor(r/4),a=new Uint8Array(y);let c=0;for(let e=0;e<r;e+=4){const o=s.substring(e,e+4);if(o.length<4)break;const f=t.indexOf(o[0]),h=t.indexOf(o[1]),l=t.indexOf(o[2]),S=t.indexOf(o[3]);if(f===-1||h===-1||l===-1||S===-1)throw new Error(`Corrupted data: Invalid ZW char detected at chunk ${c}.`);const A=S<<6|l<<4|h<<2|f;a[c]=A,c++}const u=a.subarray(0,4),E=new DataView(u.buffer).getUint32(0,!1),d=E,i=a.length-4;if(d>i)throw new Error(`Corrupted data: Header indicates ${d} bytes, but only ${i} were found.`);const g=a.subarray(4,4+E),w={message:new TextDecoder().decode(g)};self.postMessage(w)}catch(n){const s=n;self.postMessage({error:s.message})}}})();
